<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Title</title>
	<meta http-equiv="X-UA-Compatible" content="IE=edge"> 
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="css/font-awesome.css">
 	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
	<script src="https://code.jquery.com/jquery-1.11.1.js"></script>
	<script src="https://cdn.socket.io/socket.io-1.4.5.js"></script>
	<style>
	*{
	outline:1px solid rgba(255,0,0,0.3);}
		html { overflow:hidden; }
		.cont_tamano{height: 325px;background-size: cover;overflow-y: scroll;}
		.srilo_lt{color:#233F5F;font-family: 'Big Caslon', 'Book Antiqua', 'Palatino Linotype', Georgia, serif;	}
		.fondo 	{background: url("https://scontent-grt2-1.xx.fbcdn.net/v/t1.0-0/p206x206/13240076_1066962823342607_1870583144777676715_n.jpg?oh=6ff01de6897bad90ada5ef59207f5554&oe=57E61875"); background-size: cover; display: none; }
		#bienvenida { border: 1px solid #708E89;padding: 18%  18%  22% 4%;background: url("http://ecotrip.es/wp-content/uploads/2016/04/redes_sociales.jpg"); background-size: cover; }
		#chat { border: 1px solid #708E89; display: none; }
		.arriba{background-color:#E8E9EB; }
		.abajo{ background-color:#fff; -moz-box-shadow: 0px 5px 7px #121a17; -webkit-box-shadow: 0px 5px 7px #121a17;
			box-shadow: 0px 5px 7px #121a17;}
		.foto{ border-radius: 100%; max-width: 56%; padding: 6% 0%; }
		.foto2{ border-radius: 100%; max-width: 155%; padding: 19% 0%; }
		.mg0{ margin: 0%; }
		.mg2{ padding:6% 0%; }
		.pd0{ padding: 0% 2%; }
		.btnp{ margin-top: 2.5%; }
		.icono1{ padding: 15px 1px;}
		.list_mens{ background-color: #fff; background-size: cover; overflow-y: scroll; padding-top: 3%; height: 450px;	}
		#buscar{ width: 95%; border:none; }
		.border_buscar{ border:1px solid #B2B2B2; }
		.foto_chat{ background:url("http://img3.todoiphone.net/wp-content/uploads/2014/03/WhatsApp-Wallpaper-30.jpg");}
		.border_media{ border-left:1px solid #000; }
		.icono1, .glyphicon{ color: #4F7EAD; }
		.label-danger{ font-size: 16px;	font-family: Calibri, Candara, Segoe, 'Segoe UI', Optima, Arial, sans-serif;
			color:#F19726;background-color: transparent;}
		.list-group-item, .ancho_integ{ width: 40%;	margin: 2% ;padding:1%;	border-bottom-left-radius: 19px;
			border-bottom-right-radius: 17px; border-top-right-radius: 17px; }
		.magl{ 	margin-left: 6%; }
		.mglad{ width: 26%; }
		.patty{ width: 47%; margin: 2% 2% 2% 4%; padding:1%; background-color: #DCF8C6; float: right; }
		.scrollbar::-webkit-scrollbar-track { -webkit-box-shadow: inset 0 0 6px rgba(0,0,0,0.3); border-radius: 10px;
				background-color: #F5F5F5; 	}
		.scrollbar::-webkit-scrollbar { width: 8px; background-color: #F5F5F5; 	}
		.scrollbar::-webkit-scrollbar-thumb { border-radius: 10px; 	-webkit-box-shadow: inset 0 0 6px rgba(0,0,0,.3);
				background-color: #555; }
		.cont_tamano, .cont_tamano > ul{
   		 transform:rotateX(180deg);
   		 -ms-transform:rotateX(180deg); /* IE 9 */
   		 -webkit-transform:rotateX(180deg); /* Safari and Chrome */
		}
		@media(max-width:991px){ .foto2{ max-width: 60px;}.border_buscar{	margin-left: 2%;} .border_media{
				border-bottom:1px solid #B2B2B2;text-align: center; } .mglad{width: 84%; } html{ overflow: visible;}
			#bienvenida{padding: 59% 18%;} }
	</style>
</head>
<body>
		<div id="bienvenida" class="well">
			<h5 class="srilo_lt " style="font-size:30px;"><strong>Bienvenid@</strong>, a mi Whatssapatty</h5>
			<h5 class="srilo_lt " style="font-size:20px;">Por favor ingresa tu nombre para ingresar</h5>
			<input type="text" placeholder="Nombre de usuario" id="nombre" class="form-control btnp mglad" >
			<button class="btn btn-warning btnp"  onclick="guardarNombre()">Entrar al Chat</button>
		</div>
	<div class="fondo" id="contenedor_chat">
		<div class="container mg2">
			<div class="row arriba ">
				<div class="col-md-4 ">
					<div class="row ">
						<div class="col-md-2 mg0"><img class="foto2 "src="https://scontent-grt2-1.xx.fbcdn.net/v/t1.0-9/12715736_1003281066377450_7069962673418698348_n.jpg?oh=3fa1175479dc0137995ffa2df90367c0&oe=57E22C58"></div>
						<div class="col-md-8 text-center"><p class="srilo_lt"> <spam><strong>Estado:</spam></strong>"Detras de una gran mujer,hay un cabron que le pone el pie para que se caiga."</p></div>
						<div class="col-md-2 pd0 ">
						<i class="icono1 pull-right glyphicon glyphicon-list-alt"></i>
						<i class=" icono1 pull-right glyphicon glyphicon-th-list"></i>
						 </div>
					</div>
				</div>
				<div class="col-md-8 border_media">
					<div class="row ">
						<div class="col-md-2 "><img class="foto"src="https://d262ilb51hltx0.cloudfront.net/fit/c/60/60/1*zksGmHsUGSEqbtzrQMuhVA.png"></div>
						<div class="col-md-8 "><p class="mg0 srilo_lt"><strong>Laboratoria Arequipa</strong></p>
						<p class="srilo_lt"><strong>Patty :)</strong></p>
						<p id="ultimo_mj" class="srilo_lt text-center"></p>
						</div>
						<div class="col-md-2">
						<i class="icono1 pull-right glyphicon glyphicon-list-alt"></i>
						<i class=" icono1 pull-right glyphicon glyphicon-paperclip"></i>
						 </div>
					</div>	
				</div>	
			</div>
			<div class="row abajo">
				<div class="col-md-4">
					<div class="row ">
						<div class="border_buscar">
							<i class="glyphicon glyphicon-zoom-in"></i>
							<input type="text" id="buscar" class="buscador srilo_lt" placeholder="Buscar o empezar un nuevo Chat" >
							</input>
						</div>
						<div class="list_mens foto_chat scrollbar text-center" id="style-1" >
							<ul id="nombres" class="list-group srilo_lt magl "></ul>
						</div>
					</div>
				</div>	
				<div class="col-md-8">
						<div class="row foto_chat">
							<div class=" cont_tamano scrollbar" id="style-1" >
								<ul id="lista_mensajes" class="list-group srilo_lt"></ul>
							</div>			
							
							<div id="chat" class="well mg0">
								<input srilo_lt type="text" id="mensaje" class="form-control srilo_lt ">
								<button class="btnp srilo_lt" onclick="enviarMensaje()">Enviar mensaje</button>
								<button class="btnp srilo_lt" onclick="limpiarMensajes()">Limpiar mensajes</button>
								<div  class="fb-like pull-left btnp"
								  data-share="true"
								  data-width="450"
								  data-show-faces="true">
								</div>
								<p>
									<small class="srilo_lt " style="font-size:11px;">Chat creado por Patricia Mendoza Soncco</small>
								</p>
								
							</div>
						</div>	
				</div>
			</div>
		</div>
	</div>

	<script>
    (function($){
        $(window).load(function(){
            $(".prueba").mCustomScrollbar({
            	theme:"dark-thin"
            });
		});
    })(jQuery);
</script>
	<script>//codigo para saber cuantas personas entran a mi pagina a traves de google
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-78171375-1', 'auto');
  ga('send', 'pageview');

</script>
	<script> //codigo del face
  window.fbAsyncInit = function() {
    FB.init({
      appId      : '1724034374550565',
      xfbml      : true,
      version    : 'v2.6'
    });
  };
  (function(d, s, id){
     var js, fjs = d.getElementsByTagName(s)[0];
     if (d.getElementById(id)) {return;}
     js = d.createElement(s); js.id = id;
     js.src = "//connect.facebook.net/en_US/sdk.js";
     fjs.parentNode.insertBefore(js, fjs);
   }(document, 'script', 'facebook-jssdk'));
</script>
<script>
$(document).ready(function(){
	$('#nombre').keypress(function(e) {
    if(e.which == 13) {
    	guardarNombre();
    }
	});
	$('#mensaje').keypress(function(e) {
    if(e.which == 13) {
    	enviarMensaje(); 
        }
	});
});
</script>
<script>
		var socket = io('/');
		var nombre;
		var listUsers = new Array();
		var x=0;
		var i=0;
		var cont_integ=0;
		function guardarNombre()
		{
			nombre = $('#nombre').val();
			$('#bienvenida').hide();
			$('#contenedor_chat').show();
			$('#chat').show();
		}
		function enviarMensaje()
		{
			socket.emit('chat', "<span class='label label-danger'>" +  nombre + "</span> : " + $('#mensaje').val()  );
			$('#mensaje').val('');
			$('#mensaje').focus();
		}
		function limpiarMensajes()
		{
			$('#lista_mensajes').html('');
		}
		function checkUser(_name)
		{
			var check = false;
			for(var i=0 in listUsers)
			{
				if(_name == listUsers[i])
				 	check = true;
			}
			return check;
		}
		socket.on('nuevo_mensaje', function (_msg)
		{
			var indexEnd = _msg.indexOf('</span>');
			var indexStart = 33;
			var nombre = _msg.substring(indexStart, indexEnd);
			if (nombre=="Patty") {
				$('#lista_mensajes').append('<li class="list-group-item patty">' + _msg + '</li>');
			} 
			else {
					$('#lista_mensajes').append('<li class="list-group-item">' + _msg + '</li>');
			}
			if(!checkUser(nombre))
			{
				switch (cont_integ){
					case 0:
						$('#nombres').append('<li class="list-group-item-success ancho_integ">' + nombre + '</li>');
						listUsers.push(nombre);
						cont_integ=1
						break;
					case 1:
						$('#nombres').append('<li class="list-group-item-info ancho_integ">' + nombre + '</li>');
						listUsers.push(nombre);
						cont_integ=2
						break;
					case 2:
						$('#nombres').append('<li class="list-group-item-warning ancho_integ">' + nombre + '</li>');
						listUsers.push(nombre);
						cont_integ=3
						break;
					case 3:
						$('#nombres').append('<li class="list-group-item-danger ancho_integ">' + nombre + '</li>');
						listUsers.push(nombre);
						cont_integ=0
						break;
				}
			}
			$('#ultimo_mj').html('');
			$('#ultimo_mj').append('<p>' + _msg + '</p>');
		});
	</script>
</body>
</html>